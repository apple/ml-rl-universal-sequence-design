#
# For licensing see accompanying LICENSE file.
# Copyright (C) 2026 Apple Inc. All Rights Reserved.
#

# beta expansion, take from
# He, Gaoning, Jean-Claude Belfiore, Ingmar Land, Ganghua Yang, Xiaocheng Liu, Ying Chen, Rong Li et al. "Beta-expansion: A theoretical framework for fast and recursive construction of polar codes." In GLOBECOM 2017-2017 IEEE Global Communications Conference, pp. 1-6. IEEE, 2017.
import numpy as np

def int2bin(in_vec, n):
    # n: bitwidth
    bin_mat = ((in_vec.reshape(-1, 1) & (2 ** np.arange(n))) != 0).astype(int)
    bin_mat = bin_mat[:, ::-1]
    return bin_mat

def get_beta_exp(N):
    n = np.log2(N).astype(int)
    indices = np.arange(N)
    bin_mat = int2bin(indices,n)

    beta = 1.1892 # 2^(1/4)
    pvec = np.arange(n)[::-1]
    beta_pvec = np.power(beta, pvec)
    beta_exp_mat = bin_mat * beta_pvec
    beta_exp_vec = np.sum(beta_exp_mat, 1)
    beta_seq = np.argsort(beta_exp_vec)
    return beta_seq

def get_beta_exp_seq():

    beta_seq = [
       0,    1,    2,    4,    8,   16,    3,   32,    5,    6,    9,   64,   10,   17,   12,   18,
     128,   33,   20,   34,    7,   24,   36,   65,   11,  256,   66,   40,   13,   19,   68,   14,
     129,   48,   21,   72,  130,   35,   22,   25,  512,  132,   37,   80,   26,   38,  257,   67,
     136,   41,   28,  258,   96,   69,   42,   15,  144,   49,  260,   70,   44,   73,  131,   50,
      23, 1024,  264,   74,  160,  513,  133,   52,   81,   27,   76,  514,  134,   39,  272,   82,
     137,   56,   29,  516,  259,  192,   97,  138,   84,   43,   30,  145,  288,   98,  261,   71,
     520,  140,   45,   88,  146,   51,  262,  100, 1025,   46,  265,   75,  161,  528,  148,   53,
     320, 1026,  266,  104,   77,  162,  515,  135,   54,  273,   83,  152,   57, 1028,  268,   78,
     544,  164,  517,  274,  193,  112,  139,   85,   58,   31, 1032,  518,  384,  289,  194,   99,
     276,  168,   86,  521,  141,   60,   89,  147,  290,  576,  263,  196,  101,  522,  142, 1040,
      47,  280,   90,  176,  529,  149,  292,  102,  321, 1027,  524,  267,  200,  105,   92,  163,
     530,  150,   55,  322, 1056,  153,  296, 1029,  106,  269,   79,  640,  545,  165,  532,  275,
     208,  113,  154,  324,   59, 1030,  270,  108,  546, 1033,  166,  519,  385,  304,  195,  114,
     277,  169,   87,  536,  156,   61, 1088,  328, 1034,  548,  386,  291,  224,  577,  278,  197,
     170,  116,  523,  143, 1041,   62,  281,   91,  177, 1036,  768,  578,  388,  293,  198,  103,
     552,  336,  172, 1042,  525,  282,  201,  120,   93,  178,  531,  151,  294,  580,  323, 1152,
    1057,  526,  392,  297,  202, 1044,  107,  284,   94,  641,  560,  180,  533,  209,  352, 1058,
     155,  325,  298, 1031,  584,  271,  204,  109,  642,  547, 1048,  167,  534,  400,  305,  210,
     115,  184,  326,  537, 1060,  157,  300, 1089,  110,  329, 1035,  644,  549,  387,  306,  225,
     592,  279,  212,  171,  117,  538,  158, 1280,   63, 1090,  330, 1064,  550,  416, 1037,  769,
     226,  579,  389,  308,  199,  648,  118,  553,  337,  173, 1043,  540,  283,  216,  121, 1092,
     332,  179, 1038,  770,  608,  390,  295,  228,  581,  554,  338, 1153,  174, 1072,  527,  393,
     312,  203, 1045,  122,  285,   95,  656,  561,  181, 1096,  772,  582,  448,  353, 1154, 1059,
     556,  394,  340,  299,  232, 1046,  585,  286,  205,  124,  643,  562, 1049,  182,  535,  401,
     211,  354, 1536,  185,  327, 1156,  776, 1061,  586,  396,  301,  206, 1104,  111,  672,  344,
    1050,  645,  564,  402,  307,  240,  593,  213,  186,  356,  539, 1062,  159, 1281,  302, 1091,
     588,  331, 1160, 1065,  646,  551,  417, 1052,  784,  227,  594,  404,  309,  214,  649,  119,
     568,  188, 1282,  541, 1120,  217,  360, 1093, 1066,  333,  418, 1039,  771,  704,  609,  391,
     310,  229,  650,  596,  555,  339, 1168,  175, 1073,  542,  408,  313,  218, 1284,  123, 1094,
     334,  657, 1068,  800,  610,  420, 1097,  773,  230,  583,  449,  368, 1155,  652, 1074,  557,
     395,  341,  314,  233, 1047,  600,  287,  220,  125,  658,  563, 1288,  183, 1098,  774,  612,
     450,  355, 1184, 1537,  558,  424,  342, 1157,  777,  234, 1076,  587,  397,  316,  207, 1105,
     126,  673,  345, 1051,  660,  565,  403,  241, 1100,  832, 1538,  452,  187,  357, 1158,  778,
    1063,  616,  398, 1296,  303,  236, 1106,  589,  674,  346, 1161, 1080,  647,  566,  432, 1053,
     785,  242,  595,  405,  215,  664,  358,  569, 1540,  189, 1283, 1216,  780, 1121,  590,  456,
     361, 1162, 1108, 1067,  676,  348,  419, 1054,  786,  705,  624,  406,  311,  244,  651,  597,
     570, 1169,  190, 1312,  543,  409, 1122,  219, 1285,  362, 1095, 1544,  335, 1164,  896, 1069,
     801,  706,  611,  421, 1112,  788,  231,  680,  598,  464,  369, 1170,  653, 1075,  572,  410,
     315,  248, 1286,  601, 1124,  221,  364,  659, 1070,  802, 1289,  422, 1099,  775,  708,  613,
     451,  370, 1185,  654, 1552,  559,  425,  343, 1172,  792,  235, 1077,  602,  412,  317,  222,
    1344,  127,  688, 1290,  661, 1128,  804,  614,  480, 1101,  833, 1186, 1539,  453,  426,  372,
    1159,  779,  712, 1078,  617,  399, 1297,  318,  237, 1107,  604,  675,  347, 1176, 1081,  662,
     567,  433, 1292,  243, 1102,  834, 1568,  454,  665,  359, 1188,  808, 1541,  618,  428, 1298,
    1217,  781,  238, 1136,  591,  457,  376, 1163, 1109, 1082,  677,  349,  434, 1055,  787,  720,
     625,  407,  245,  666,  836,  571, 1542, 1408,  191, 1313, 1218,  782, 1123,  620,  458, 1300,
     363, 1192, 1110, 1545,  678,  350, 1165,  897, 1084,  816,  707,  626,  436, 1113,  789,  246,
     681,  599,  465, 1171,  668, 1314,  573,  411, 1600,  249, 1287, 1220,  840, 1125, 1546,  460,
     365, 1166,  898, 1071,  803,  736, 1304,  423, 1114,  790,  709,  682,  628,  466,  371, 1200,
     655, 1553,  574,  440, 1173,  793,  250, 1316,  603,  413, 1126,  223, 1345,  366,  689, 1548,
    1291, 1224,  900, 1129,  805,  710,  615,  481, 1116,  848, 1187,  684, 1554,  468,  427,  373,
    1174,  794,  713, 1079,  632,  414,  319,  252, 1346,  605,  690, 1177, 1320,  663, 1130,  806,
    1293,  482, 1103,  835, 1664, 1569,  455,  904,  374, 1189,  809,  714, 1556,  619,  429, 1299,
    1232,  796,  239, 1137,  606,  472,  377, 1178, 1348, 1083,  692,  435, 1294,  721, 1132,  864,
    1570,  484,  667,  837, 1190,  810, 1543, 1409,  430, 1328, 1219,  783,  716, 1138,  621,  459,
    1301,  378, 1193, 1111, 1560,  679,  351, 1180,  912, 1085,  817,  722,  627,  437, 1352,  247,
     696,  838, 1572, 1410,  669, 1315, 1248,  812, 1601,  622,  488, 1302, 1221,  841, 1194, 1140,
    1547,  461,  380, 1167,  899, 1086,  818,  737, 1305,  438, 1115,  791,  724,  683,  629,  467,
    1201,  670, 1792,  575,  441, 1602, 1412,  251, 1317, 1222,  842, 1127, 1576,  462, 1360,  367,
    1196,  928, 1549,  738, 1306, 1225,  901, 1144,  820,  711,  630,  496, 1117,  849, 1202,  685,
    1555,  469,  442, 1175,  795,  728, 1318,  633,  415, 1604,  253, 1347,  844,  691, 1550, 1416,
    1321, 1226,  902, 1131,  807,  740, 1308,  483, 1118,  850, 1665,  686, 1584,  470,  905,  375,
    1204,  824,  715, 1557,  634,  444, 1233,  797,  254, 1376,  607,  473, 1179, 1349, 1322,  693,
    1608, 1295, 1228,  960, 1133,  865, 1666, 1571,  485,  906,  852, 1191,  811,  744, 1558, 1424,
     431, 1329, 1234,  798,  717, 1139,  636,  474,  379, 1208, 1350, 1561,  694, 1181,  913, 1324,
     723, 1134,  866, 1353,  486,  697,  839, 1668, 1573, 1411,  908, 1330, 1249,  813,  718, 1616,
     623,  489, 1303, 1236,  856, 1195, 1141, 1562,  476,  381, 1182,  914, 1087,  819,  752,  439,
    1354,  725,  698,  868, 1574, 1440,  671, 1793, 1250,  814, 1603, 1413,  490, 1332, 1223,  843,
    1672, 1142, 1577,  463, 1361,  382, 1197,  929, 1564,  739, 1307, 1240,  916, 1145,  821,  726,
     631,  497, 1356, 1203,  700, 1794,  443, 1632, 1414,  729, 1319, 1252,  872, 1605, 1578,  492,
    1362,  845, 1198,  930, 1551, 1417, 1336, 1227,  903, 1146,  822,  741, 1309,  498, 1119,  851,
    1680,  687, 1585,  471,  920, 1205,  825,  730, 1796,  635,  445, 1606, 1472,  255, 1377,  846,
    1580, 1418, 1364, 1323, 1256,  932, 1609,  742, 1310, 1229,  961, 1148,  880, 1667, 1586,  500,
     907,  853, 1206,  826,  745, 1559, 1425,  446, 1235,  799,  732, 1378,  637,  475, 1209, 1351,
    1800,  695, 1610, 1420, 1325, 1230,  962, 1135,  867, 1696, 1368,  487,  936,  854, 1669,  746,
    1588, 1426,  909, 1331, 1264,  828,  719, 1617,  638,  504, 1237,  857, 1210, 1380, 1563,  477,
    1183,  915, 1326,  753, 1612, 1355,  964,  699,  869, 1670, 1575, 1441,  910, 1808, 1251,  815,
     748, 1618, 1428,  491, 1333, 1238,  858, 1673, 1143, 1592,  478,  383, 1212,  944, 1565,  754,
    1241,  917, 1384,  727,  870, 1357, 1442,  701, 1795, 1728, 1633, 1415,  968, 1334, 1253,  873,
    1674, 1620, 1579,  493, 1363,  860, 1199,  931, 1566, 1432, 1337, 1242,  918, 1147,  823,  756,
     499, 1358, 1681,  702, 1824,  921, 1634, 1444,  731, 1797, 1254,  874, 1607, 1473,  494, 1392,
     847, 1676, 1581, 1419, 1365, 1338, 1257,  933, 1624,  743, 1311, 1244,  976, 1149,  881, 1682,
    1587,  501,  922, 1207,  827,  760, 1798,  447, 1636, 1474,  733, 1379,  876, 1582, 1448, 1366,
    1801, 1258,  934, 1611, 1421, 1340, 1231,  963, 1150,  882, 1697, 1369,  502,  937,  855, 1684,
     747, 1589, 1427,  924, 1265,  829,  734, 1856,  639,  505, 1476, 1211, 1381, 1802, 1640, 1422,
    1327, 1260,  992, 1613, 1698, 1370,  965,  938,  884, 1671, 1590, 1456,  911, 1809, 1266,  830,
     749, 1619, 1429,  506, 1239,  859, 1688, 1382, 1593,  479, 1213,  945, 1804,  755, 1614, 1480,
    1385,  966,  871, 1700, 1372, 1443,  940, 1810, 1729,  750, 1648, 1430,  969, 1335, 1268,  888,
    1675, 1621, 1594,  508,  861, 1214,  946, 1567, 1433, 1243,  919, 1386,  757, 1359, 1920,  703,
    1825, 1730, 1635, 1445,  970, 1812, 1255,  875, 1704, 1622, 1488,  495, 1393,  862, 1677, 1596,
    1434, 1339, 1272,  948, 1625,  758, 1245,  977, 1388, 1683, 1826,  923, 1446,  761, 1799, 1732,
    1637, 1475,  972, 1394,  877, 1678, 1583, 1449, 1367, 1816, 1259,  935, 1626, 1436, 1341, 1246,
     978, 1151,  883, 1712,  503,  952, 1685,  762, 1828,  925, 1638, 1504,  735, 1857,  878, 1477,
    1450, 1396, 1803, 1736, 1641, 1423, 1342, 1261,  993, 1628, 1699, 1371,  980,  939,  885, 1686,
    1591, 1457,  926, 1267,  831,  764, 1858,  507, 1478, 1689, 1383, 1832, 1642, 1452, 1805, 1262,
     994, 1615, 1481, 1400,  967,  886, 1701, 1373, 1458,  941, 1811, 1744,  751, 1649, 1431,  984,
    1269,  889, 1690, 1860, 1595,  509, 1215,  947, 1806, 1644, 1482, 1387,  996, 1702, 1374, 1921,
     942, 1840, 1731, 1650, 1460,  971, 1813, 1270,  890, 1705, 1623, 1489,  510,  863, 1692, 1597,
    1435, 1273,  949, 1864,  759, 1484, 1389, 1922, 1827, 1760, 1447, 1000, 1814, 1733, 1706, 1652,
    1490,  973, 1395,  892, 1679, 1598, 1464, 1817, 1274,  950, 1627, 1437, 1247,  979, 1390, 1713,
     953, 1924,  763, 1829, 1734, 1639, 1505,  974, 1872,  879, 1708, 1492, 1451, 1397, 1818, 1737,
    1656, 1438, 1343, 1276, 1008, 1629, 1714,  981,  954, 1687, 1830,  927, 1506,  765, 1859, 1479,
    1928, 1398, 1833, 1738, 1643, 1453, 1820, 1263,  995, 1630, 1496, 1401,  982,  887, 1716, 1459,
     956, 1745,  766, 1888,  985, 1508, 1691, 1861, 1834, 1454, 1807, 1740, 1645, 1483, 1402,  997,
    1703, 1375, 1936,  943, 1841, 1746, 1651, 1461,  986, 1271,  891, 1720, 1862,  511, 1693, 1836,
    1646, 1512, 1865,  998, 1485, 1404, 1923, 1842, 1761, 1462, 1001, 1815, 1748, 1707, 1653, 1491,
     988,  893, 1694, 1599, 1465, 1275,  951, 1866, 1486, 1391, 1952, 1762, 1925, 1002, 1844, 1735,
    1654, 1520,  975, 1873,  894, 1709, 1493, 1466, 1819, 1752, 1657, 1439, 1277, 1009, 1868, 1715,
     955, 1926, 1831, 1764, 1507, 1004, 1874, 1710, 1494, 1929, 1399, 1848, 1739, 1658, 1468, 1821,
    1278, 1010, 1631, 1497,  983, 1717,  957, 1984,  767, 1889, 1509, 1930, 1876, 1835, 1768, 1455,
    1822, 1741, 1660, 1498, 1403, 1012, 1718, 1937,  958, 1747, 1890,  987, 1510, 1721, 1863, 1932,
    1837, 1742, 1647, 1513, 1880,  999, 1500, 1405, 1938, 1843, 1776, 1463, 1016, 1749, 1722, 1892,
     989, 1695, 1838, 1514, 1867, 1487, 1406, 1953, 1763, 1940, 1003, 1845, 1750, 1655, 1521,  990,
     895, 1724, 1467, 1753, 1896, 1516, 1869, 1954, 1927, 1846, 1765, 1522, 1005, 1875, 1711, 1495,
    1944, 1849, 1754, 1659, 1469, 1279, 1011, 1870, 1956, 1766, 1985, 1006, 1904, 1524, 1931, 1877,
    1850, 1769, 1470, 1823, 1756, 1661, 1499, 1013, 1719,  959, 1986, 1891, 1511, 1960, 1878, 1770,
    1933, 1852, 1743, 1662, 1528, 1881, 1014, 1501, 1939, 1777, 1017, 1988, 1723, 1893, 1934, 1839,
    1772, 1515, 1882, 1502, 1407, 1968, 1778, 1941, 1018, 1751, 1894,  991, 1725, 1992, 1897, 1517,
    1884, 1955, 1942, 1847, 1780, 1523, 1020, 1726, 1945, 1755, 1898, 1518, 1871, 1957, 1767, 2000,
    1007, 1905, 1525, 1946, 1851, 1784, 1471, 1757, 1900, 1958, 1987, 1906, 1526, 1961, 1879, 1771,
    1948, 1853, 1758, 1663, 1529, 1015, 2016, 1989, 1962, 1908, 1935, 1854, 1773, 1530, 1883, 1503,
    1969, 1779, 1019, 1990, 1895, 1964, 1774, 1993, 1912, 1532, 1885, 1970, 1943, 1781, 1021, 1727,
    1994, 1899, 1519, 1886, 1972, 1782, 2001, 1022, 1947, 1785, 1996, 1901, 1959, 2002, 1907, 1527,
    1976, 1786, 1949, 1759, 1902, 2017, 2004, 1963, 1909, 1950, 1855, 1788, 1531, 2018, 1991, 1910,
    1965, 1775, 2008, 1913, 1533, 1971, 2020, 1966, 1995, 1914, 1534, 1887, 1973, 1783, 1023, 2024,
    1997, 1916, 1974, 2003, 1977, 1787, 1998, 1903, 2032, 2005, 1978, 1951, 1789, 2019, 2006, 1911,
    1980, 1790, 2009, 2021, 1967, 2010, 1915, 1535, 2022, 2025, 2012, 1917, 1975, 2026, 1999, 1918,
    2033, 1979, 2028, 2034, 2007, 1981, 1791, 2036, 1982, 2011, 2023, 2040, 2013, 2027, 2014, 1919,
    2029, 2035, 2030, 2037, 1983, 2038, 2041, 2042, 2015, 2044, 2031, 2039, 2043, 2045, 2046, 2047,
    ]

    return np.array(beta_seq)

def get_nr_seq():

    nr_seq = [
         0,   1,   2,   4,   8,  16,  32,   3,   5,  64,   9,   6,  17,  10,  18, 128,
        12,  33,  65,  20, 256,  34,  24,  36,   7, 129,  66, 512,  11,  40,  68, 130,
        19,  13,  48,  14,  72, 257,  21, 132,  35, 258,  26, 513,  80,  37,  25,  22,
       136, 260, 264,  38, 514,  96,  67,  41, 144,  28,  69,  42, 516,  49,  74, 272,
       160, 520, 288, 528, 192, 544,  70,  44, 131,  81,  50,  73,  15, 320, 133,  52,
        23, 134, 384,  76, 137,  82,  56,  27,  97,  39, 259,  84, 138, 145, 261,  29,
        43,  98, 515,  88, 140,  30, 146,  71, 262, 265, 161, 576,  45, 100, 640,  51,
       148,  46,  75, 266, 273, 517, 104, 162,  53, 193, 152,  77, 164, 768, 268, 274,
       518,  54,  83,  57, 521, 112, 135,  78, 289, 194,  85, 276, 522,  58, 168, 139,
        99,  86,  60, 280,  89, 290, 529, 524, 196, 141, 101, 147, 176, 142, 530, 321,
        31, 200,  90, 545, 292, 322, 532, 263, 149, 102, 105, 304, 296, 163,  92,  47,
       267, 385, 546, 324, 208, 386, 150, 153, 165, 106,  55, 328, 536, 577, 548, 113,
       154,  79, 269, 108, 578, 224, 166, 519, 552, 195, 270, 641, 523, 275, 580, 291,
        59, 169, 560, 114, 277, 156,  87, 197, 116, 170,  61, 531, 525, 642, 281, 278,
       526, 177, 293, 388,  91, 584, 769, 198, 172, 120, 201, 336,  62, 282, 143, 103,
       178, 294,  93, 644, 202, 592, 323, 392, 297, 770, 107, 180, 151, 209, 284, 648,
        94, 204, 298, 400, 608, 352, 325, 533, 155, 210, 305, 547, 300, 109, 184, 534,
       537, 115, 167, 225, 326, 306, 772, 157, 656, 329, 110, 117, 212, 171, 776, 330,
       226, 549, 538, 387, 308, 216, 416, 271, 279, 158, 337, 550, 672, 118, 332, 579,
       540, 389, 173, 121, 553, 199, 784, 179, 228, 338, 312, 704, 390, 174, 554, 581,
       393, 283, 122, 448, 353, 561, 203,  63, 340, 394, 527, 582, 556, 181, 295, 285,
       232, 124, 205, 182, 643, 562, 286, 585, 299, 354, 211, 401, 185, 396, 344, 586,
       645, 593, 535, 240, 206,  95, 327, 564, 800, 402, 356, 307, 301, 417, 213, 568,
       832, 588, 186, 646, 404, 227, 896, 594, 418, 302, 649, 771, 360, 539, 111, 331,
       214, 309, 188, 449, 217, 408, 609, 596, 551, 650, 229, 159, 420, 310, 541, 773,
       610, 657, 333, 119, 600, 339, 218, 368, 652, 230, 391, 313, 450, 542, 334, 233,
       555, 774, 175, 123, 658, 612, 341, 777, 220, 314, 424, 395, 673, 583, 355, 287,
       183, 234, 125, 557, 660, 616, 342, 316, 241, 778, 563, 345, 452, 397, 403, 207,
       674, 558, 785, 432, 357, 187, 236, 664, 624, 587, 780, 705, 126, 242, 565, 398,
       346, 456, 358, 405, 303, 569, 244, 595, 189, 566, 676, 361, 706, 589, 215, 786,
       647, 348, 419, 406, 464, 680, 801, 362, 590, 409, 570, 788, 597, 572, 219, 311,
       708, 598, 601, 651, 421, 792, 802, 611, 602, 410, 231, 688, 653, 248, 369, 190,
       364, 654, 659, 335, 480, 315, 221, 370, 613, 422, 425, 451, 614, 543, 235, 412,
       343, 372, 775, 317, 222, 426, 453, 237, 559, 833, 804, 712, 834, 661, 808, 779,
       617, 604, 433, 720, 816, 836, 347, 897, 243, 662, 454, 318, 675, 618, 898, 781,
       376, 428, 665, 736, 567, 840, 625, 238, 359, 457, 399, 787, 591, 678, 434, 677,
       349, 245, 458, 666, 620, 363, 127, 191, 782, 407, 436, 626, 571, 465, 681, 246,
       707, 350, 599, 668, 790, 460, 249, 682, 573, 411, 803, 789, 709, 365, 440, 628,
       689, 374, 423, 466, 793, 250, 371, 481, 574, 413, 603, 366, 468, 655, 900, 805,
       615, 684, 710, 429, 794, 252, 373, 605, 848, 690, 713, 632, 482, 806, 427, 904,
       414, 223, 663, 692, 835, 619, 472, 455, 796, 809, 714, 721, 837, 716, 864, 810,
       606, 912, 722, 696, 377, 435, 817, 319, 621, 812, 484, 430, 838, 667, 488, 239,
       378, 459, 622, 627, 437, 380, 818, 461, 496, 669, 679, 724, 841, 629, 351, 467,
       438, 737, 251, 462, 442, 441, 469, 247, 683, 842, 738, 899, 670, 783, 849, 820,
       728, 928, 791, 367, 901, 630, 685, 844, 633, 711, 253, 691, 824, 902, 686, 740,
       850, 375, 444, 470, 483, 415, 485, 905, 795, 473, 634, 744, 852, 960, 865, 693,
       797, 906, 715, 807, 474, 636, 694, 254, 717, 575, 913, 798, 811, 379, 697, 431,
       607, 489, 866, 723, 486, 908, 718, 813, 476, 856, 839, 725, 698, 914, 752, 868,
       819, 814, 439, 929, 490, 623, 671, 739, 916, 463, 843, 381, 497, 930, 821, 726,
       961, 872, 492, 631, 729, 700, 443, 741, 845, 920, 382, 822, 851, 730, 498, 880,
       742, 445, 471, 635, 932, 687, 903, 825, 500, 846, 745, 826, 732, 446, 962, 936,
       475, 853, 867, 637, 907, 487, 695, 746, 828, 753, 854, 857, 504, 799, 255, 964,
       909, 719, 477, 915, 638, 748, 944, 869, 491, 699, 754, 858, 478, 968, 383, 910,
       815, 976, 870, 917, 727, 493, 873, 701, 931, 756, 860, 499, 731, 823, 922, 874,
       918, 502, 933, 743, 760, 881, 494, 702, 921, 501, 876, 847, 992, 447, 733, 827,
       934, 882, 937, 963, 747, 505, 855, 924, 734, 829, 965, 938, 884, 506, 749, 945,
       966, 755, 859, 940, 830, 911, 871, 639, 888, 479, 946, 750, 969, 508, 861, 757,
       970, 919, 875, 862, 758, 948, 977, 923, 972, 761, 877, 952, 495, 703, 935, 978,
       883, 762, 503, 925, 878, 735, 993, 885, 939, 994, 980, 926, 764, 941, 967, 886,
       831, 947, 507, 889, 984, 751, 942, 996, 971, 890, 509, 949, 973,1000, 892, 950,
       863, 759,1008, 510, 979, 953, 763, 974, 954, 879, 981, 982, 927, 995, 765, 956,
       887, 985, 997, 986, 943, 891, 998, 766, 511, 988,1001, 951,1002, 893, 975, 894,
      1009, 955,1004,1010, 957, 983, 958, 987,1012, 999,1016, 767, 989,1003, 990,1005,
       959,1011,1013, 895,1006,1014,1017,1018, 991,1020,1007,1015,1019,1021,1022,1023,
       ]

    return np.array(nr_seq)



if __name__ == "__main__":

    N = 1024
    K = 128
    seq = get_nr_seq()
    seq_N = seq[seq < N]
    fbm = np.zeros((N,), dtype=int)
    indices = seq_N[-K:]
    fbm[indices] = 1
    print(fbm.tolist())

    exit()

    N = 2048
    beta_seq = get_beta_exp(N)

    beta_seq = get_beta_exp_seq()
    print (beta_seq.tolist())

    exit()

    C = 16
    R = N//C
    for r in range(R):
        for c in range(C):
            idx = r*C + c
            print(f'{beta_seq[idx]:4d}, ', end='')
        print('')





